<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="products_item_inh" inherit_id="website_sale.product"
              name="Products Fields">
        <xpath expr='//t[@t-call="website.layout"]/div/section/div[2]/div[2]/h1' position="after">
            <div>
                <b>
                    <span t-field="product.x_aa_gp_short_description"/>
                </b>
            </div>
        </xpath>
    </template>
    <template id="variants_customise" inherit_id="website_sale.variants">
        <xpath expr="//ul" position="replace">
            <ul t-attf-class="list-unstyled js_add_cart_variants mb-0 #{ul_class}" t-att-data-attribute_exclusions="json.dumps(attribute_exclusions)">
                <t t-foreach="product.valid_product_template_attribute_line_ids" t-as="ptal">
                    <!-- Attributes selection is hidden if there is only one value available and it's not a custom value -->
                    <li t-att-data-attribute_id="ptal.attribute_id.id"
                        t-att-data-attribute_name="ptal.attribute_id.name"
                        t-att-data-attribute_display_type="ptal.attribute_id.display_type" t-att-data-is_ral_color="ptal.attribute_id.x_aa_ol_is_ral_color"
                        t-attf-class="variant_attribute #{'d-none' if len(ptal.product_template_value_ids._only_active()) == 1 and not ptal.product_template_value_ids._only_active()[0].is_custom else ''}">

                        <!-- Used to customize layout if the only available attribute value is custom -->
                        <t t-set="single" t-value="len(ptal.product_template_value_ids._only_active()) == 1"/>
                        <t t-set="single_and_custom" t-value="single and ptal.product_template_value_ids._only_active()[0].is_custom" />
                        <strong t-field="ptal.attribute_id.name" class="attribute_name"/>

                        <t t-if="ptal.attribute_id.display_type == 'select'">
                            <select
                                t-att-data-attribute_id="ptal.attribute_id.id"
                                t-attf-class="form-select css_attribute_select o_wsale_product_attribute js_variant_change #{ptal.attribute_id.create_variant} #{'d-none' if single_and_custom else ''}"
                                t-att-name="'ptal-%s' % ptal.id"  t-att-data-is_ral_color="ptal.attribute_id.x_aa_ol_is_ral_color">
                                <t t-foreach="ptal.product_template_value_ids._only_active()" t-as="ptav">
                                    <option t-att-value="ptav.id"
                                        t-att-data-value_id="ptav.id"
                                        t-att-data-value_name="ptav.name"
                                        t-att-data-attribute_name="ptav.attribute_id.name"
                                        t-att-data-is_custom="ptav.is_custom"
                                        t-att-selected="ptav in combination"
                                        t-att-data-is_single="single"
                                        t-att-data-is_single_and_custom="single_and_custom"
                                        t-att-data-is_color="ptav.product_attribute_value_id.x_aa_ol_is_color">
                                        <span t-field="ptav.name"/>
                                        <t t-call="website_sale.badge_extra_price"/>
                                    </option>
                                </t>
                            </select>
                            <t t-if="ptal.attribute_id.x_aa_ol_is_ral_color">
                                <select name="color_id" id="color_id" class="form-control d-none">
                                    <option value="">Select RAL Color Options...</option>
                                    <t t-foreach="colors or []" t-as="color">
                                        <option t-att-value="color.id"
                                                t-att-selected="color.id == int(color_id) if color_id else color.id == False">
                                            <t t-esc="color.x_aa_ol_name"/>
                                        </option>
                                    </t>
                                </select>
                                <p id="colorcode_show" class="text-danger text-left"
                                   style="display:none;margin-top: 2%;margin-left:2%">Please Fill Color Code
                                </p>
                            </t>
                        </t>
                        <t t-elif="ptal.attribute_id.display_type in ('radio', 'multi')">
                            <ul t-att-data-attribute_id="ptal.attribute_id.id" t-attf-class="list-inline list-unstyled o_wsale_product_attribute #{'d-none' if single_and_custom else ''}" t-att-data-is_ral_color="ptal.attribute_id.x_aa_ol_is_ral_color">
                                <t t-foreach="ptal.product_template_value_ids._only_active()" t-as="ptav">
                                    <li class="list-inline-item mb-3 js_attribute_value" style="margin: 0;">
                                        <label class="col-form-label">
                                            <div class="form-check">
                                                <input t-att-type="'radio' if ptal.attribute_id.display_type == 'radio' else 'checkbox'"
                                                    t-attf-class="form-check-input js_variant_change #{ptal.attribute_id.create_variant}"
                                                    t-att-checked="ptav in combination"
                                                    t-att-name="'ptal-%s' % ptal.id"
                                                    t-att-value="ptav.id"
                                                    t-att-data-value_id="ptav.id"
                                                    t-att-data-value_name="ptav.name"
                                                    t-att-data-attribute_name="ptav.attribute_id.name"
                                                    t-att-data-is_custom="ptav.is_custom"
                                                    t-att-data-is_single="single"
                                                    t-att-data-is_color="ptav.product_attribute_value_id.x_aa_ol_is_color"
                                                    t-att-data-is_single_and_custom="single_and_custom"/>
                                                <div class="radio_input_value form-check-label">
                                                    <span t-field="ptav.name"/>
                                                    <t t-call="website_sale.badge_extra_price"/>
                                                </div>
                                            </div>
                                        </label>
                                    </li>
                                </t>
                            </ul>
                        </t>

                        <t t-elif="ptal.attribute_id.display_type == 'pills'">
                            <ul t-att-data-attribute_id="ptal.attribute_id.id"
                                t-attf-class="btn-group-toggle list-inline list-unstyled o_wsale_product_attribute #{'d-none' if single_and_custom else ''}"
                                data-bs-toggle="buttons" t-att-data-is_ral_color="ptal.attribute_id.x_aa_ol_is_ral_color">
                                <t t-foreach="ptal.product_template_value_ids._only_active()" t-as="ptav">
                                    <li t-attf-class="o_variant_pills btn btn-primary mb-1 list-inline-item js_attribute_value #{'active' if ptav in combination else ''}">
                                        <input type="radio"
                                            t-attf-class="js_variant_change #{ptal.attribute_id.create_variant}"
                                            t-att-checked="ptav in combination"
                                            t-att-name="'ptal-%s' % ptal.id"
                                            t-att-value="ptav.id"
                                            t-att-data-value_id="ptav.id"
                                            t-att-id="ptav.id"
                                            t-att-data-value_name="ptav.name"
                                            t-att-data-attribute_name="ptav.attribute_id.name"
                                            t-att-data-is_custom="ptav.is_custom"
                                            t-att-data-is_color="ptav.product_attribute_value_id.x_aa_ol_is_color"
                                            t-att-data-is_single_and_custom="single_and_custom"
                                            t-att-autocomplete="off"/>
                                        <label class="radio_input_value o_variant_pills_input_value"
                                               t-att-for="ptav.id">
                                            <span t-field="ptav.name"/>
                                            <t t-call="website_sale.badge_extra_price"/>
                                        </label>
                                    </li>
                                </t>
                            </ul>
                        </t>

                        <t t-elif="ptal.attribute_id.display_type == 'color'">
                            <ul t-att-data-attribute_id="ptal.attribute_id.id" t-attf-class="list-inline o_wsale_product_attribute #{'d-none' if single_and_custom else ''}" t-att-data-is_ral_color="ptal.attribute_id.x_aa_ol_is_ral_color">
                                <li t-foreach="ptal.product_template_value_ids._only_active()" t-as="ptav" class="list-inline-item me-1">
                                    <t t-set="img_style"
                                       t-value="'background:url(/web/image/product.template.attribute.value/%s/image); background-size:cover;' % ptav.id if ptav.image else ''"
                                    />
                                    <t t-set="color_style"
                                       t-value="'background:' + str(ptav.html_color or ptav.name if not ptav.is_custom else '')"
                                    />
                                    <label t-attf-style="#{img_style or color_style}"
                                           t-attf-class="css_attribute_color #{'active' if ptav in combination else ''} #{'custom_value' if ptav.is_custom else ''} #{'transparent' if (not ptav.is_custom and not ptav.html_color) else ''}"
                                    >
                                          <input type="radio"
                                            t-attf-class="js_variant_change  #{ptal.attribute_id.create_variant}"
                                            t-att-checked="ptav in combination"
                                            t-att-name="'ptal-%s' % ptal.id"
                                            t-att-value="ptav.id"
                                            t-att-title="ptav.name"
                                            t-att-data-value_id="ptav.id"
                                            t-att-data-value_name="ptav.name"
                                            t-att-data-attribute_name="ptav.attribute_id.name"
                                            t-att-data-is_custom="ptav.is_custom"
                                            t-att-data-is_single="single"
                                            t-att-data-is_single_and_custom="single_and_custom"
                                            t-att-data-is_color="ptav.product_attribute_value_id.x_aa_ol_is_color"/>
                                    </label>
                                </li>
                            </ul>
                        </t>
                    </li>
                </t>
            </ul>
        </xpath>
    </template>
<!--     <template id="variants_customise" inherit_id="website_sale.variants">
        <xpath expr="//ul" position="replace">
            <ul t-attf-class="list-unstyled js_add_cart_variants #{ul_class}"
                t-att-data-attribute_exclusions="json.dumps(attribute_exclusions)">
                <t t-foreach="product.valid_product_template_attribute_line_ids" t-as="ptal">
                    <li t-att-data-attribute_id="ptal.attribute_id.id"
                        t-att-data-attribute_name="ptal.attribute_id.name"
                        t-att-data-is_ral_color="ptal.attribute_id.x_aa_ol_is_ral_color"
                        t-attf-class="variant_attribute #{'d-none' if len(ptal.product_template_value_ids._only_active()) == 1 and not ptal.product_template_value_ids._only_active()[0].is_custom else ''}">
                        <t t-set="single" t-value="len(ptal.product_template_value_ids._only_active()) == 1"/>
                        <t t-set="single_and_custom"
                           t-value="single and ptal.product_template_value_ids._only_active()[0].is_custom"/>
                        <strong t-field="ptal.attribute_id.name" class="attribute_name"/>

                        <t t-if="ptal.attribute_id.display_type == 'select'">
                            <select
                                    t-att-data-attribute_id="ptal.attribute_id.id"
                                    t-attf-class="form-control js_variant_change #{ptal.attribute_id.create_variant} #{'d-none' if single_and_custom else ''}"
                                    t-att-name="'ptal-%s' % ptal.id"
                                    t-att-data-is_ral_color="ptal.attribute_id.x_aa_ol_is_ral_color">
                                <t t-foreach="ptal.product_template_value_ids._only_active()" t-as="ptav">
                                    <t t-set="combination_info_variant"
                                       t-value="product._get_combination_info(ptav, pricelist=pricelist)"/>
                                    <option t-att-value="ptav.id"
                                            t-att-data-value_id="ptav.id"
                                            t-att-data-value_name="ptav.name"
                                            t-att-data-attribute_name="ptav.attribute_id.name"
                                            t-att-data-is_custom="ptav.is_custom"
                                            t-att-data-is_color="ptav.product_attribute_value_id.x_aa_ol_is_color"
                                            t-att-selected="ptav in combination"
                                            t-att-data-is_single="single"
                                            t-att-data-is_single_and_custom="single_and_custom">
                                        <span t-field="ptav.name"/>
                                        <span t-if="combination_info_variant['price_extra']"
                                              class="badge badge-pill badge-secondary">
                                            <t t-esc="combination_info_variant['price_extra'] > 0 and '+' or '-'"/>
                                            <span t-esc="abs(combination_info_variant['price_extra'])"
                                                  class="variant_price_extra" style="white-space: nowrap;"
                                                  t-options='{
                                                "widget": "monetary",
                                                "display_currency": (pricelist or product).currency_id
                                            }'/>
                                        </span>
                                    </option>
                                </t>
                            </select>
                            <t t-if="ptal.attribute_id.x_aa_ol_is_ral_color">
                                <select name="color_id" id="color_id" class="form-control d-none">
                                    <option value="">Select RAL Color Options...</option>
                                    <t t-foreach="colors or []" t-as="color">
                                        <option t-att-value="color.id"
                                                t-att-selected="color.id == int(color_id) if color_id else color.id == False">
                                            <t t-esc="color.x_aa_ol_name"/>
                                        </option>
                                    </t>
                                </select>
                                <p id="colorcode_show" class="text-danger text-left"
                                   style="display:none;margin-top: 2%;margin-left:2%">Please Fill Color Code
                                </p>
                            </t>
                        </t>

                        <t t-if="ptal.attribute_id.display_type == 'radio'">
                            <ul t-att-data-attribute_id="ptal.attribute_id.id"
                                t-attf-class="list-unstyled #{'d-none' if single_and_custom else ''}"
                                t-att-data-is_ral_color="ptal.attribute_id.x_aa_ol_is_ral_color">
                                <t t-foreach="ptal.product_template_value_ids._only_active()" t-as="ptav">
                                    <t t-set="combination_info_variant"
                                       t-value="product._get_combination_info(ptav, pricelist=pricelist)"/>
                                    <li class="form-group js_attribute_value" style="margin: 0;">
                                        <label class="col-form-label">
                                            <div>
                                                <input type="radio"
                                                       t-attf-class="js_variant_change radio_input #{ptal.attribute_id.create_variant}"
                                                       t-att-checked="ptav in combination"
                                                       t-att-name="'ptal-%s' % ptal.id"
                                                       t-att-value="ptav.id"
                                                       t-att-data-value_id="ptav.id"
                                                       t-att-data-value_name="ptav.name"
                                                       t-att-data-attribute_name="ptav.attribute_id.name"
                                                       t-att-data-is_custom="ptav.is_custom"
                                                       t-att-data-is_color="ptav.product_attribute_value_id.x_aa_ol_is_color"
                                                       t-att-data-is_single="single"
                                                       t-att-data-is_single_and_custom="single_and_custom"/>
                                                <div class="radio_input_value">
                                                    <span t-field="ptav.name"/>
                                                    <span class="badge badge-pill badge-secondary"
                                                          t-if="combination_info_variant['price_extra']">
                                                        <t t-esc="combination_info_variant['price_extra'] > 0 and '+' or '-'"/>
                                                        <span t-esc="abs(combination_info_variant['price_extra'])"
                                                              class="variant_price_extra" style="white-space: nowrap;"
                                                              t-options='{
                                                            "widget": "monetary",
                                                            "display_currency": (pricelist or product).currency_id
                                                        }'/>
                                                    </span>
                                                </div>
                                            </div>
                                        </label>
                                    </li>
                                </t>
                            </ul>
                        </t>

                        <t t-if="ptal.attribute_id.display_type == 'color'">
                            <ul t-att-data-attribute_id="ptal.attribute_id.id"
                                t-attf-class="list-inline  #{'d-none' if single_and_custom else ''}"
                                t-att-data-is_ral_color="ptal.attribute_id.x_aa_ol_is_ral_color">
                                <li t-foreach="ptal.product_template_value_ids._only_active()" t-as="ptav"
                                    class="list-inline-item">
                                    <label t-attf-style="background-color:#{ptav.html_color or ptav.product_attribute_value_id.name if not ptav.is_custom else ''}"
                                           t-attf-class="css_attribute_color #{'active' if ptav in combination else ''} #{'custom_value' if ptav.is_custom else ''}">
                                        <input type="radio"
                                               t-attf-class="js_variant_change  #{ptal.attribute_id.create_variant}"
                                               t-att-checked="ptav in combination"
                                               t-att-name="'ptal-%s' % ptal.id"
                                               t-att-value="ptav.id"
                                               t-att-title="ptav.name"
                                               t-att-data-value_id="ptav.id"
                                               t-att-data-value_name="ptav.name"
                                               t-att-data-attribute_name="ptav.attribute_id.name"
                                               t-att-data-is_custom="ptav.is_custom"
                                               t-att-data-is_color="ptav.product_attribute_value_id.x_aa_ol_is_color"
                                               t-att-data-is_single="single"
                                               t-att-data-is_single_and_custom="single_and_custom"/>
                                    </label>
                                </li>
                            </ul>
                        </t>
                        <t t-if="ptal.attribute_id.display_type in ['radio_circle', 'radio_square', 'radio_image']">
                            <ul t-att-data-attribute_id="ptal.attribute_id.id"
                                t-attf-class="list-unstyled d-flex flex-wrap align-items-start dr-variant #{'d-none' if single_and_custom else ''}">
                                <t t-foreach="ptal.product_template_value_ids._only_active()" t-as="ptav">
                                    <li class="form-group js_attribute_value" style="margin: 0;">
                                        <label>
                                            <div>
                                                <input type="radio"
                                                       t-attf-class="js_variant_change radio_input d-none #{ptal.attribute_id.create_variant}"
                                                       t-att-checked="ptav in combination"
                                                       t-att-name="'ptal-%s' % ptal.id"
                                                       t-att-value="ptav.id"
                                                       t-att-data-value_id="ptav.id"
                                                       t-att-data-value_name="ptav.name"
                                                       t-att-data-attribute_name="ptav.attribute_id.name"
                                                       t-att-data-is_custom="ptav.is_custom"
                                                       t-att-data-is_single_and_custom="single_and_custom"/>
                                                <div class="radio_input_value d-flex flex-column align-items-center">
                                                    <div t-if="not ptal.attribute_id.display_type == 'radio_image'"
                                                         t-attf-class="dr-variant-item font-weight-normal #{ptal.attribute_id.display_type == 'radio_circle' and 'circle' or 'square'}"
                                                         t-field="ptav.name"/>
                                                    <div t-else="" class="dr-variant-item image" t-att-title="ptav.name"
                                                         t-field="ptav.dr_image" t-options="{'widget': 'image'}"/>
                                                    <span class="badge badge-pill badge-primary mt-1"
                                                          t-if="ptav.price_extra">
                                                        <t t-esc="ptav.price_extra > 0 and '+' or '-'"/>
                                                        <span t-esc="abs(ptav.price_extra)" class="variant_price_extra"
                                                              style="white-space: nowrap;"
                                                              t-options='{
                                                            "widget": "monetary",
                                                            "from_currency": product.currency_id,
                                                            "display_currency": (pricelist or product).currency_id
                                                        }'/>
                                                    </span>
                                                </div>
                                            </div>
                                        </label>
                                    </li>
                                </t>
                            </ul>
                        </t>
                    </li>
                </t>
            </ul>
        </xpath>
    </template> -->
    <template id="cart_lines_onlevel" inherit_id="website_sale.cart_lines" name="Cart Lines">
        <xpath expr="//div[hasclass('d-flex', 'flex-column', 'align-items-end')]" position="after">
            <t t-set="tot_count" t-value="int(line.product_uom_qty)"/>
                <t t-if="line.product_uom.factor != 1">
                    <t t-set="tot_count" t-value="int(line.product_uom_qty / line.product_uom.factor)"/>
                </t>
                <t t-set="integer" t-value="line._get_real_number(line.product_uom_qty)"/>
                <t t-if="integer">
                <span t-esc="int(line.product_uom_qty)"/>
                <t t-esc="line.product_uom.name"/>
                <t t-if="line.product_uom.factor != 1">
                    <br>
                    <span>(Total</span>
                    <t t-esc="tot_count" style="border-style: none;"/>
                    <t t-esc="line.product_uom.p_name" style="border-style: none;"/>
                    <span>)</span>
                    </br>
                </t> <br/>
                <t t-if="line.product_id.product_tmpl_id.x_aa_ol_length">
                    <t t-if="line._get_real_number(line.product_id.product_tmpl_id.x_aa_ol_length * line.product_uom_qty / 1000)">
                        <span>(</span><span t-esc="(int((line.product_id.product_tmpl_id.x_aa_ol_length / 1000) * tot_count))"/><span>m</span><span>)</span>
                    </t>
                    <t t-else="">
                        <span>(</span><span t-esc="(line.product_id.product_tmpl_id.x_aa_ol_length / 1000) * tot_count "/><span>m</span><span>)</span>
                    </t>
                </t>
                <t t-elif="line.product_uom_qty != line.x_aa_ol_total_buom">
                    <span>(Total </span><t t-esc="'%.0f' % line.x_aa_ol_total_buom"/><span style="padding-left:4px;">pcs.</span><span>)</span>
                </t>
            </t>
            <t t-else="">
                <span t-esc="int(line.product_uom_qty)"/>
                <t t-esc="line.product_uom.name"/>
                <t t-if="line.product_uom.factor != 1">
                    <br>
                    <span>(Total</span>

                    <t t-esc="tot_count" style="border-style: none;"/>
                    <t t-esc="line.product_uom.p_name" style="border-style: none;"/>
                    <span>)</span>
                    </br>
                </t> <br/>

                <t t-if="line.product_id.product_tmpl_id.x_aa_ol_length">
                    <t t-if="line._get_real_number(line.product_id.product_tmpl_id.x_aa_ol_length * line.product_uom_qty / 1000)">
                        <span>(</span><span t-esc="int((line.product_id.product_tmpl_id.x_aa_ol_length / 1000 ) * tot_count)"/><span>m</span><span>)</span>
                    </t>
                    <t t-else="">
                        <span>(</span><span t-esc="(line.product_id.product_tmpl_id.x_aa_ol_length/ 1000) * tot_count"/><span>m</span><span>)</span>
                    </t>
                </t>
                <t t-elif="line.product_uom_qty != line.x_aa_ol_total_buom">
                    <span>(Total </span><t t-esc="(str('%.2f'%(line.x_aa_ol_total_buom))).replace('.',',')"/><span style="padding-left:4px;">pcs.</span><span>)</span>
                </t>
            </t>
        </xpath>
        <xpath expr="//div[hasclass('d-flex', 'flex-column', 'align-items-end')]" position="before">
            <div class="d-flex flex-column align-items-end" t-if="line.x_aa_gp_color_code">
                RAL Code : <input type="text" name="x_aa_gp_color_code"
                       t-att-value="line.x_aa_gp_color_code"
                      id="x_aa_gp_color_code" class="form-control color-code text-center"
                        readonly="readonly" style="background:white; border:0px !important;"></input>
            </div>
        </xpath>
    </template>
    <template id="product_price_inh" inherit_id="website_sale.product_price">
        <xpath expr="//h3/span" position="after">
            <t t-if="request.env.user.id == request.env.ref('base.public_user').id">
                <span>(excl.VAT)</span>
            </t>
        </xpath>
        <xpath expr="//h3" position="after">
            <h6 style="margin-top:10px; color:grey;">
                <t t-set="list_price" t-value="combination_info['list_price']"/>
                <span id="uom_unit_price" t-esc="list_price" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}" />  per <span id="uom_name" t-esc="product.uom_id.name"></span>
            </h6>
        </xpath>
    </template>
</odoo>